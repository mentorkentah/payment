<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Account | LUMIEARN</title>
  <meta name="description"
        content="Lumiearn | Your one stop solution to the world of financial oportunities. Join our thousands of people making real money online.">
<!-- OPEN GRAPH / SOCIAL PREVIEW -->
<meta property="og:title" content="Create Account | LUMIEARN">
<meta property="og:description" content="Lumiearn | Your one stop solution to the world of financial oportunities. Join our thousands of people making real money online.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://lumiearn.vercel.app/register.html">
<meta property="og:image" content="https://lumiearn.vercel.app/logo.png?v=2">

<!-- TWITTER / X CARD -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Create Account | LUMIEARN">
<meta name="twitter:description" content="Lumiearn | Your one stop solution to the world of financial oportunities. Join our thousands of people making real money online.">
<meta name="twitter:image" content="https://lumiearn.vercel.app/logo.png?v=2">

<!-- Orbitron Font -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

<style>
html, body{margin:0;padding:0;height:100%;}
body{
  font-family:'Orbitron', sans-serif;
  background:#0a0a0f;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
}
.register-card{
  background:#111118;
  max-width:520px;
  width:100%;
  border-radius:16px;
  padding:34px 30px;
  box-shadow:0 0 20px rgba(0,255,240,0.25);
}
.brand-logo {
    width: 320px;  /* change this to whatever size you want */
    height: auto;  /* keeps the logo proportional */
    display: block;
    margin: 0 auto;
}
.brand{text-align:center;margin-bottom:24px;}
.brand h1{margin:0;font-size:32px;color:#00fff0;}
.brand p{font-size:14px;color:#0ff;opacity:.8;}
#alertBox{display:none;margin-top:12px;padding:12px 16px;border-radius:12px;font-size:14px;font-weight:500;text-align:center;}
.form-group{margin-bottom:18px;}
label{font-size:14px;font-weight:600;margin-bottom:8px;display:block;color:#0ff;}
.input-box{position:relative;}
.input-box i.left-icon{position:absolute;top:50%;left:16px;transform:translateY(-50%);font-size:16px;color:#0ff;pointer-events:none;}
.input-box .toggle-password{position:absolute;right:16px;top:50%;transform:translateY(-50%);cursor:pointer;font-size:16px;color:#0ff;}
.input-box input{width:100%;height:54px;padding-left:44px;padding-right:44px;font-size:15px;border-radius:14px;border:1px solid rgba(0,255,240,.4);background:transparent;color:#fff;box-sizing:border-box;}
.input-box input:focus{outline:none;border-color:#0ff;box-shadow:0 0 12px rgba(0,255,240,.35);}
.phone-input{display:flex;border:1px solid rgba(0,255,240,.4);border-radius:14px;overflow:hidden;height:54px;align-items:center;}
.country-input{display:flex;align-items:center;justify-content:flex-start;padding:0 8px;background:#111118;cursor:pointer;font-size:15px;color:#fff;white-space:nowrap;gap:5px;position:relative;min-width:130px;}
.country-text{display:flex;align-items:center;gap:5px;}
.country-toggle{cursor:pointer;font-size:16px;color:#0ff;}
.separator{display:inline-block;width:1px;height:24px;background:rgba(255,255,255,0.2);margin:0 8px;}
.phone-input input[type="tel"]{flex:1;padding:0 12px;font-size:15px;background:transparent;border:none;color:#fff;height:100%;}
.phone-input input[type="tel"]:focus{outline:none;}
.locked{height:54px;background:transparent;cursor:not-allowed;color:#fff;padding:0 16px;font-size:15px;border-radius:14px;border:1px solid rgba(0,255,240,.4);width:100%;box-sizing:border-box;}
.terms{display:flex;gap:10px;font-size:13px;color:#0ff;margin:18px 0;align-items:center;}
.terms input{accent-color:#0ff;}
.btn{width:100%;height:54px;font-size:16px;font-weight:700;border:none;border-radius:16px;background:#00fff0;color:#0a0a0f;cursor:pointer;transition:.3s;}
.btn:hover{box-shadow:0 0 20px rgba(0,255,240,.6);}
.login-link{margin-top:20px;text-align:center;font-size:14px;}
.login-link a{color:#00fff0;font-weight:700;text-decoration:none;}
.password-helper{font-size:12px;color:#0ff;margin-top:4px;}
.input-error{color:#ff4d4d;font-size:12px;margin-top:5px;display:none;}
input:-webkit-autofill,input:-webkit-autofill:hover,input:-webkit-autofill:focus,
select:-webkit-autofill,select:-webkit-autofill:hover,select:-webkit-autofill:focus,
textarea:-webkit-autofill{-webkit-text-fill-color:#ffffff !important;
-webkit-box-shadow:0 0 0px 1000px #111118 inset !important;
box-shadow:0 0 0px 1000px #111118 inset !important;
transition:background-color 9999s ease-in-out 0s;
caret-color:#00fff0;}
input, select, textarea{background-color:transparent !important;}
#countryModal input{width:70%;padding:6px;border:1px solid #0ff;margin-bottom:12px;color:#fff;background:transparent;border-radius:0;}
#countryList div{text-align:left;cursor:pointer;padding:8px;border-bottom:1px solid rgba(0,255,240,.2);}
#usernameInput{font-family:'Orbitron',sans-serif;}
</style>
</head>

<body>
<div class="register-card">
  <div class="brand">
 <img src="https://lumiearn.vercel.app/logo.png" alt="LUMIEARN LOGO" class="brand-logo">
    <h1>LUMIEARN | Register</h1>
    <p>Create your account to start earning</p>
    <div id="alertBox"></div>
  </div>

<form id="registerForm">
<div class="form-group">
<label>Username</label>
<div class="input-box">
<i class="fa-solid fa-user left-icon"></i>
<input type="text" id="usernameInput" placeholder="Create a username" required>
</div>
<div class="input-error" id="usernameError">Username already exists</div>
</div>

<div class="form-group">
<label>Email</label>
<div class="input-box">
<i class="fa-solid fa-envelope left-icon"></i>
<input type="email" id="emailInput" placeholder="Enter your email" required>
</div>
<div class="input-error" id="emailError">Email already exists</div>
</div>

<div class="form-group">
<label>Phone</label>
<div class="phone-input">
  <div id="countryInput" class="country-input">
    <span class="country-text">ðŸ‡°ðŸ‡ª +254</span>
    <i class="fa-solid fa-chevron-down country-toggle"></i>
    <span class="separator"></span>
  </div>
  <input type="tel" id="phoneInput" placeholder="XXXXXXXXX" required>
</div>
<div class="input-error" id="phoneError">Phone number invalid</div>
</div>

<div class="form-group">
<label>Invited By</label>
<input type="text" id="invitedBy" readonly class="locked">
</div>

<div class="form-group">
<label>Password</label>
<div class="input-box">
<i class="fa-solid fa-lock left-icon"></i>
<input type="password" id="passwordInput" placeholder="Enter password" required>
<i class="fa-solid fa-eye toggle-password"></i>
</div>
<div class="password-helper">Password must be 4â€“12 characters</div>
</div>

<div class="form-group">
<label>Confirm Password</label>
<div class="input-box">
<i class="fa-solid fa-lock left-icon"></i>
<input type="password" id="confirmPasswordInput" placeholder="Confirm password" required>
<i class="fa-solid fa-eye toggle-password"></i>
</div>
</div>

<div class="terms">
<input type="checkbox" required>
<label>I agree to Terms & Conditions</label>
</div>

<button class="btn" type="submit">Create Account</button>
</form>

<div class="login-link">
Already have an account? <a href="login.html">Login</a>
</div>
</div>

<div id="countryModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);overflow-y:auto;z-index:9999;">
  <div style="max-width:400px;margin:60px auto;background:#111118;border-radius:16px;padding:20px;">
    <input type="text" id="countrySearch" placeholder="Search country" />
    <div id="countryList"></div>
  </div>
</div>

<script>
/* --- COUNTRIES --- */
const countries = [
  { flag:'ðŸ‡°ðŸ‡ª', code:'+254', name:'Kenya', currency:'KSH', capitalFee:300, startingProfit:100, mlmRewards:{l1:100,l2:50,l3:20} },
  { flag:'ðŸ‡ºðŸ‡¬', code:'+256', name:'Uganda', currency:'UGX', capitalFee:18500, startingProfit:4000, mlmRewards:{l1:10000,l2:5000,l3:2000} },
  { flag:'ðŸ‡¹ðŸ‡¿', code:'+255', name:'Tanzania', currency:'TZS', capitalFee:14000, startingProfit:2500, mlmRewards:{l1:5000,l2:3000,l3:1000} },
  { flag:'ðŸ‡ºðŸ‡¸', code:'+1', name:'United States', currency:'USD', capitalFee:8, startingProfit:2, mlmRewards:{l1:4,l2:2,l3:1} },
  { flag:'ðŸ‡¬ðŸ‡­', code:'+233', name:'Ghana', currency:'GHS', capitalFee:80, startingProfit:25, mlmRewards:{l1:150,l2:75,l3:25} },
  { flag:'ðŸ‡¬ðŸ‡§', code:'+44', name:'United Kingdom', currency:'GBP', capitalFee:40, startingProfit:30, mlmRewards:{l1:20,l2:10,l3:5} }
];

/* --- ELEMENTS --- */
const usernameInput = document.getElementById("usernameInput");
const emailInput = document.getElementById("emailInput");
const phoneInput = document.getElementById("phoneInput");
const countryInput = document.getElementById("countryInput");
const passwordInput = document.getElementById("passwordInput");
const confirmInput = document.getElementById("confirmPasswordInput");
const invitedByInput = document.getElementById("invitedBy");
const alertBox = document.getElementById("alertBox");
const usernameError = document.getElementById("usernameError");
const emailError = document.getElementById("emailError");
const phoneError = document.getElementById("phoneError");

/* --- REFERRAL --- */
const urlParams = new URLSearchParams(window.location.search);
const ref = urlParams.get('ref');
if(ref){ 
  localStorage.setItem("REFERRAL_CODE", ref.toUpperCase()); 
  invitedByInput.value = ref.toUpperCase(); 
} else { 
  const savedRef = localStorage.getItem("REFERRAL_CODE"); 
  invitedByInput.value = savedRef || "LUMIEARN"; 
}
invitedByInput.readOnly = true;

/* --- HELPERS --- */
function normalizeKey(str){ return str.trim().toLowerCase(); }
function checkDuplicate(field,value){
  const normalizedValue = normalizeKey(value);
  for(let k in localStorage){
    if(k.startsWith("LUMIEARN_USER_")){
      const u = JSON.parse(localStorage.getItem(k));
      if(u[field] && normalizeKey(u[field]) === normalizedValue) return true;
    }
  }
  return false;
}
function formatPhone(phone){ return "+" + phone.replace(/\D/g,''); }

/* --- VALIDATION --- */
usernameInput.addEventListener("input",()=>{ 
  usernameInput.value = usernameInput.value.replace(/[^a-zA-Z0-9]/g,''); 
  usernameError.style.display = checkDuplicate("username",usernameInput.value) ? "block" : "none"; 
});

emailInput.addEventListener("input", () => {
  emailInput.value = emailInput.value.toLowerCase();
  const isDuplicate = checkDuplicate("email", emailInput.value);
  const allowedDomains = ["@gmail.com", "@icloud.com"];
  const isValidDomain = allowedDomains.some(domain => emailInput.value.endsWith(domain));

  if(!isValidDomain){
    emailError.innerText = "Email must end with @gmail.com or @icloud.com";
    emailError.style.display = "block";
  } else if(isDuplicate){
    emailError.innerText = "Email already exists";
    emailError.style.display = "block";
  } else {
    emailError.style.display = "none";
  }
});

phoneInput.addEventListener("input", () => {
  let val = phoneInput.value.replace(/\D/g,'');
  if(val.startsWith('0') && val.length > 1) val = val.substring(1);
  if(val.length > 12) val = val.substring(0,12);
  phoneInput.value = val;

  const countryCode = countryInput.querySelector(".country-text").innerText.split(" ")[1];
  const fullPhone = "+" + countryCode.replace(/\D/g,'') + val;

  if(checkDuplicate("phone", fullPhone)){
    phoneError.innerText = "Phone number already exists";
    phoneError.style.display = "block";
  } else {
    phoneError.style.display = "none";
  }
});

function showAlert(msg,type){ 
  alertBox.style.display = "block"; 
  alertBox.innerText = msg; 
  alertBox.style.background = type==="error"?"#ff4d4d":"#0ff"; 
  alertBox.style.color = type==="error"?"#721c24":"#0a0a0f"; 
  setTimeout(()=> alertBox.style.display="none",3000); 
}

/* --- REGISTER USER --- */
document.getElementById("registerForm").addEventListener("submit", e => {
  e.preventDefault();

  const username = usernameInput.value.trim();
  const email = emailInput.value.trim().toLowerCase();
  const phoneRaw = phoneInput.value.trim();
  const countryCode = countryInput.querySelector(".country-text").innerText.split(" ")[1];
  const phone = formatPhone(countryCode + phoneRaw);
  const password = passwordInput.value;
  const confirm = confirmInput.value;
  const selectedCountry = countries.find(c => c.code === countryCode) || countries[0];

  if(!email.endsWith("@gmail.com") && !email.endsWith("@icloud.com")) return showAlert("Email must end with @gmail.com or @icloud.com", "error");
  if(password.length < 4 || password.length > 12) return showAlert("Password must be 4â€“12 characters", "error");
  if(password !== confirm) return showAlert("Passwords do not match", "error");
  if(checkDuplicate("username", username)) return showAlert("Username already exists", "error");
  if(checkDuplicate("email", email)) return showAlert("Email already exists", "error");
  if(checkDuplicate("phone", phone)) return showAlert("Phone already exists", "error");

  const storedRef = localStorage.getItem("REFERRAL_CODE");
  const referredBy = (ref || storedRef || "LUMIEARN").toUpperCase();

  const storageKey = "LUMIEARN_USER_" + normalizeKey(username);

  const newUser = {
    username,
    email,
    phone,
    password,
    country: selectedCountry.name,
    currency: selectedCountry.currency,
    capitalFee: selectedCountry.capitalFee,
    startingProfit: selectedCountry.startingProfit,
    mlmRewards: selectedCountry.mlmRewards,
    referredBy,
    referralBonus: 0,
    balance: selectedCountry.startingProfit,
    profit: selectedCountry.startingProfit,
    paid: false, // <--- USER HAS NOT PAID YET
    registeredAt: new Date().toISOString()
  };

  localStorage.setItem(storageKey, JSON.stringify(newUser));

  showAlert(`Account created successfully! Referred by: ${referredBy}`, "success");
  setTimeout(()=> location.href="login.html",3000);
});

/* --- PASSWORD TOGGLE --- */
document.querySelectorAll(".toggle-password").forEach(icon=>{
  icon.addEventListener("click",()=>{
    const input = icon.previousElementSibling;
    input.type = input.type==="password" ? "text" : "password";
    icon.classList.toggle("fa-eye");
    icon.classList.toggle("fa-eye-slash");
  });
});

/* --- COUNTRY MODAL --- */
const modal = document.getElementById("countryModal");
const searchInput = document.getElementById("countrySearch");
const listDiv = document.getElementById("countryList");

countryInput.addEventListener("click", ()=>{
  modal.style.display = "block";
  renderCountries(countries);
  searchInput.value = "";
  searchInput.focus();
});

function renderCountries(list){
  listDiv.innerHTML = "";
  list.forEach(c=>{
    const div = document.createElement("div");
    div.innerText = `${c.flag} ${c.name} (${c.currency}) ${c.code}`;
    div.addEventListener("click", ()=>{
      countryInput.querySelector(".country-text").innerText = `${c.flag} ${c.code}`;
      modal.style.display = "none";
      phoneInput.value = "";
    });
    listDiv.appendChild(div);
  });
}

searchInput.addEventListener("input", ()=>{
  const term = searchInput.value.toLowerCase();
  renderCountries(countries.filter(c => 
    c.name.toLowerCase().includes(term) || c.code.includes(term)
  ));
});

modal.addEventListener("click", e=>{
  if(e.target === modal) modal.style.display = "none";
});

  // Set the launch date (must match your countdown page)
  const launchDate = new Date(2026, 1, 9, 13, 30, 0).getTime();

  const now = Date.now();

  if (now < launchDate) {
    // Redirect to countdown page if current time is before launch
    window.location.href = "countdown.html"; // <-- your countdown page path
  }
</script>
</body>
</html>